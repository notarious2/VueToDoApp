{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { defineStore } from \"pinia\";\nimport axios from \"axios\";\nimport authHeader from \"../services/auth-header\";\nexport const useTaskStore = defineStore(\"tasks\", {\n  state: () => ({\n    display: false,\n    tasksList: [],\n    tasksSlice: [],\n    date: new Date().toISOString().slice(0, 10),\n    enteredText: \"\"\n  }),\n  actions: {\n    async loadTasks() {\n      try {\n        const response = await axios.get(\"http://localhost:8000/task\", {\n          headers: authHeader()\n        }); // working with response\n\n        const result = response.data;\n        const newArray = [];\n        result.forEach(element => {\n          if (!newArray.filter(arr => arr[\"date\"] === element.date).length > 0) {\n            newArray.push({\n              date: element.date,\n              tasks: [{ ...element,\n                editable: false\n              }]\n            });\n          } else {\n            const idx = newArray.findIndex(arr => arr.date === element.date);\n            newArray[idx].tasks.push({ ...element,\n              editable: false\n            });\n          }\n        }); // tasksList.value = newArray;\n\n        console.log(\"Load...\");\n        return newArray;\n      } catch (err) {\n        if (err.response.status === 401) {\n          localStorage.removeItem(\"user\");\n        }\n\n        console.log(err.response.status);\n      }\n    },\n\n    loadOneTask(task_date) {\n      if (this.tasksList.filter(arr => arr[\"date\"] === task_date).length === 0) {\n        this.display = false;\n        this.tasksSlice = [];\n      } else {\n        // console.log(tasksList.value.filter((arr) => arr[\"date\"] === task_date)[0]);\n        this.tasksSlice = this.tasksList.filter(arr => arr[\"date\"] === task_date)[0];\n        this.display = true; // SORT THE SLICE\n\n        this.tasksSlice.tasks.sort((a, b) => a.priority > b.priority ? 1 : b.priority > a.priority ? -1 : 0);\n      }\n    },\n\n    // Checking or unchecking specific object in an array\n    async checkUncheck(element) {\n      try {\n        await axios.patch(\"http://localhost:8000/task/update/\" + element.task_id, {\n          completed: element.completed ? false : true\n        }, {\n          headers: authHeader()\n        });\n        console.log(\"Completed!\"); // rerender ALL to-do tasks\n\n        this.tasksList = await this.loadTasks(); // get selected date's slice\n\n        this.loadOneTask(this.date);\n      } catch (err) {\n        console.log(err);\n\n        if (err.response.status === 401) {\n          localStorage.removeItem(\"user\");\n        }\n      }\n    },\n\n    // adding the task - Post Request\n    async addNewTask() {\n      // priority is 1 if there are not tasks on that day, else it is autoincremented\n      const priority = \"date\" in this.tasksSlice ? this.tasksSlice.tasks.length + 1 : 1;\n\n      if (this.enteredText !== \"\") {\n        try {\n          await axios.post(\"http://localhost:8000/task\", {\n            priority: priority,\n            date: this.date,\n            text: this.enteredText,\n            completed: false\n          }, {\n            headers: authHeader()\n          });\n          console.log(\"Add request\"); // rerender ALL to-do tasks\n\n          this.tasksList = await this.loadTasks(); // get selected date's slice\n\n          this.loadOneTask(date.value); //clear input field\n\n          this.enteredText = \"\";\n        } catch (err) {\n          if (err.response.status === 401) {\n            localStorage.removeItem(\"user\");\n          }\n\n          console.log(err);\n        }\n      } else {\n        invalidInput.value = true;\n      }\n    }\n\n  }\n});","map":{"version":3,"names":["defineStore","axios","authHeader","useTaskStore","state","display","tasksList","tasksSlice","date","Date","toISOString","slice","enteredText","actions","loadTasks","response","get","headers","result","data","newArray","forEach","element","filter","arr","length","push","tasks","editable","idx","findIndex","console","log","err","status","localStorage","removeItem","loadOneTask","task_date","sort","a","b","priority","checkUncheck","patch","task_id","completed","addNewTask","post","text","value","invalidInput"],"sources":["C:/Users/notar/Desktop/Udemy/todo_front/src/components/store/TaskStore.js"],"sourcesContent":["import { defineStore } from \"pinia\";\r\nimport axios from \"axios\";\r\nimport authHeader from \"../services/auth-header\";\r\n\r\nexport const useTaskStore = defineStore(\"tasks\", {\r\n  state: () => ({\r\n    display: false,\r\n    tasksList: [],\r\n    tasksSlice: [],\r\n    date: new Date().toISOString().slice(0, 10),\r\n    enteredText: \"\",\r\n  }),\r\n  actions: {\r\n    async loadTasks() {\r\n      try {\r\n        const response = await axios.get(\"http://localhost:8000/task\", {\r\n          headers: authHeader(),\r\n        });\r\n        // working with response\r\n        const result = response.data;\r\n        const newArray = [];\r\n        result.forEach((element) => {\r\n          if (\r\n            !newArray.filter((arr) => arr[\"date\"] === element.date).length > 0\r\n          ) {\r\n            newArray.push({\r\n              date: element.date,\r\n              tasks: [{ ...element, editable: false }],\r\n            });\r\n          } else {\r\n            const idx = newArray.findIndex((arr) => arr.date === element.date);\r\n            newArray[idx].tasks.push({ ...element, editable: false });\r\n          }\r\n        });\r\n        // tasksList.value = newArray;\r\n        console.log(\"Load...\");\r\n        return newArray;\r\n      } catch (err) {\r\n        if (err.response.status === 401) {\r\n          localStorage.removeItem(\"user\");\r\n        }\r\n        console.log(err.response.status);\r\n      }\r\n    },\r\n    loadOneTask(task_date) {\r\n      if (\r\n        this.tasksList.filter((arr) => arr[\"date\"] === task_date).length === 0\r\n      ) {\r\n        this.display = false;\r\n        this.tasksSlice = [];\r\n      } else {\r\n        // console.log(tasksList.value.filter((arr) => arr[\"date\"] === task_date)[0]);\r\n        this.tasksSlice = this.tasksList.filter(\r\n          (arr) => arr[\"date\"] === task_date\r\n        )[0];\r\n        this.display = true;\r\n        // SORT THE SLICE\r\n        this.tasksSlice.tasks.sort((a, b) =>\r\n          a.priority > b.priority ? 1 : b.priority > a.priority ? -1 : 0\r\n        );\r\n      }\r\n    },\r\n\r\n    // Checking or unchecking specific object in an array\r\n    async checkUncheck(element) {\r\n      try {\r\n        await axios.patch(\r\n          \"http://localhost:8000/task/update/\" + element.task_id,\r\n          { completed: element.completed ? false : true },\r\n          { headers: authHeader() }\r\n        );\r\n        console.log(\"Completed!\");\r\n        // rerender ALL to-do tasks\r\n        this.tasksList = await this.loadTasks();\r\n        // get selected date's slice\r\n        this.loadOneTask(this.date);\r\n      } catch (err) {\r\n        console.log(err);\r\n        if (err.response.status === 401) {\r\n          localStorage.removeItem(\"user\");\r\n        }\r\n      }\r\n    },\r\n    // adding the task - Post Request\r\n    async addNewTask() {\r\n      // priority is 1 if there are not tasks on that day, else it is autoincremented\r\n      const priority =\r\n        \"date\" in this.tasksSlice ? this.tasksSlice.tasks.length + 1 : 1;\r\n      if (this.enteredText !== \"\") {\r\n        try {\r\n          await axios.post(\r\n            \"http://localhost:8000/task\",\r\n            {\r\n              priority: priority,\r\n              date: this.date,\r\n              text: this.enteredText,\r\n              completed: false,\r\n            },\r\n            {\r\n              headers: authHeader(),\r\n            }\r\n          );\r\n          console.log(\"Add request\");\r\n\r\n          // rerender ALL to-do tasks\r\n          this.tasksList = await this.loadTasks();\r\n          // get selected date's slice\r\n          this.loadOneTask(date.value);\r\n          //clear input field\r\n          this.enteredText = \"\";\r\n        } catch (err) {\r\n          if (err.response.status === 401) {\r\n            localStorage.removeItem(\"user\");\r\n          }\r\n          console.log(err);\r\n        }\r\n      } else {\r\n        invalidInput.value = true;\r\n      }\r\n    },\r\n  },\r\n});\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}