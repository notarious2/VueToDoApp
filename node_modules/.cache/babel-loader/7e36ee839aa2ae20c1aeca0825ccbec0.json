{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { defineStore } from \"pinia\";\nimport axios from \"axios\";\nimport router from \"../../router.js\";\nexport const useAuthStore = defineStore(\"authentication\", {\n  state: () => ({\n    token: \"\",\n    // initialize state from local storage to enable user to stay logged in\n    user: JSON.parse(localStorage.getItem(\"user\")),\n    errorLogIn: false\n  }),\n  getters: {\n    isAuthenticated: state => !!state.token\n  },\n  actions: {\n    async login(username, password) {\n      const params = new URLSearchParams();\n      params.append(\"username\", username);\n      params.append(\"password\", password);\n      const headers = {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n      };\n      await axios.post(\"login\", params, {\n        headers: headers\n      }).then(response => {\n        // store user details and jwt in local storage to keep user logged in between page refreshes\n        localStorage.setItem(\"user\", JSON.stringify(response.data)); // update pinia state\n\n        this.token = response.data[\"access_token\"];\n        router.push({\n          name: \"Home\"\n        });\n      }).catch(error => {\n        console.log(error);\n        this.errorLogIn = true;\n      });\n    },\n\n    async register(payload) {\n      await axios.post(\"user\", payload).then(response => {\n        router.push({\n          name: \"Authorization\"\n        });\n        console.log(`User ${response.data.username} has been successfully created!`);\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n\n    logout() {\n      this.token = null;\n      localStorage.removeItem(\"user\");\n    },\n\n    clearError() {\n      this.errorLogIn = false;\n    }\n\n  },\n  persist: {\n    enabled: true\n  }\n});","map":{"version":3,"names":["defineStore","axios","router","useAuthStore","state","token","user","JSON","parse","localStorage","getItem","errorLogIn","getters","isAuthenticated","actions","login","username","password","params","URLSearchParams","append","headers","Accept","post","then","response","setItem","stringify","data","push","name","catch","error","console","log","register","payload","logout","removeItem","clearError","persist","enabled"],"sources":["C:/Users/notar/Desktop/Udemy/todo_front/src/components/store/userAuth.js"],"sourcesContent":["import { defineStore } from \"pinia\";\r\nimport axios from \"axios\";\r\nimport router from \"../../router.js\";\r\n\r\nexport const useAuthStore = defineStore(\"authentication\", {\r\n  state: () => ({\r\n    token: \"\",\r\n    // initialize state from local storage to enable user to stay logged in\r\n    user: JSON.parse(localStorage.getItem(\"user\")),\r\n    errorLogIn: false,\r\n  }),\r\n  getters: {\r\n    isAuthenticated: (state) => !!state.token,\r\n  },\r\n  actions: {\r\n    async login(username, password) {\r\n      const params = new URLSearchParams();\r\n      params.append(\"username\", username);\r\n      params.append(\"password\", password);\r\n\r\n      const headers = {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n      };\r\n      await axios\r\n        .post(\"login\", params, {\r\n          headers: headers,\r\n        })\r\n        .then((response) => {\r\n          // store user details and jwt in local storage to keep user logged in between page refreshes\r\n          localStorage.setItem(\"user\", JSON.stringify(response.data));\r\n          // update pinia state\r\n          this.token = response.data[\"access_token\"];\r\n          router.push({ name: \"Home\" });\r\n        })\r\n        .catch((error) => {\r\n          console.log(error);\r\n          this.errorLogIn = true;\r\n        });\r\n    },\r\n    async register(payload) {\r\n      await axios\r\n        .post(\"user\", payload)\r\n        .then((response) => {\r\n          router.push({ name: \"Authorization\" });\r\n          console.log(\r\n            `User ${response.data.username} has been successfully created!`\r\n          );\r\n        })\r\n        .catch((error) => {\r\n          console.log(error);\r\n        });\r\n    },\r\n    logout() {\r\n      this.token = null;\r\n      localStorage.removeItem(\"user\");\r\n    },\r\n\r\n    clearError() {\r\n      this.errorLogIn = false;\r\n    },\r\n  },\r\n  persist: {\r\n    enabled: true,\r\n  },\r\n});\r\n"],"mappings":";AAAA,SAASA,WAAT,QAA4B,OAA5B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,iBAAnB;AAEA,OAAO,MAAMC,YAAY,GAAGH,WAAW,CAAC,gBAAD,EAAmB;EACxDI,KAAK,EAAE,OAAO;IACZC,KAAK,EAAE,EADK;IAEZ;IACAC,IAAI,EAAEC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAHM;IAIZC,UAAU,EAAE;EAJA,CAAP,CADiD;EAOxDC,OAAO,EAAE;IACPC,eAAe,EAAGT,KAAD,IAAW,CAAC,CAACA,KAAK,CAACC;EAD7B,CAP+C;EAUxDS,OAAO,EAAE;IACP,MAAMC,KAAN,CAAYC,QAAZ,EAAsBC,QAAtB,EAAgC;MAC9B,MAAMC,MAAM,GAAG,IAAIC,eAAJ,EAAf;MACAD,MAAM,CAACE,MAAP,CAAc,UAAd,EAA0BJ,QAA1B;MACAE,MAAM,CAACE,MAAP,CAAc,UAAd,EAA0BH,QAA1B;MAEA,MAAMI,OAAO,GAAG;QACdC,MAAM,EAAE,kBADM;QAEd,gBAAgB;MAFF,CAAhB;MAIA,MAAMrB,KAAK,CACRsB,IADG,CACE,OADF,EACWL,MADX,EACmB;QACrBG,OAAO,EAAEA;MADY,CADnB,EAIHG,IAJG,CAIGC,QAAD,IAAc;QAClB;QACAhB,YAAY,CAACiB,OAAb,CAAqB,MAArB,EAA6BnB,IAAI,CAACoB,SAAL,CAAeF,QAAQ,CAACG,IAAxB,CAA7B,EAFkB,CAGlB;;QACA,KAAKvB,KAAL,GAAaoB,QAAQ,CAACG,IAAT,CAAc,cAAd,CAAb;QACA1B,MAAM,CAAC2B,IAAP,CAAY;UAAEC,IAAI,EAAE;QAAR,CAAZ;MACD,CAVG,EAWHC,KAXG,CAWIC,KAAD,IAAW;QAChBC,OAAO,CAACC,GAAR,CAAYF,KAAZ;QACA,KAAKrB,UAAL,GAAkB,IAAlB;MACD,CAdG,CAAN;IAeD,CAzBM;;IA0BP,MAAMwB,QAAN,CAAeC,OAAf,EAAwB;MACtB,MAAMnC,KAAK,CACRsB,IADG,CACE,MADF,EACUa,OADV,EAEHZ,IAFG,CAEGC,QAAD,IAAc;QAClBvB,MAAM,CAAC2B,IAAP,CAAY;UAAEC,IAAI,EAAE;QAAR,CAAZ;QACAG,OAAO,CAACC,GAAR,CACG,QAAOT,QAAQ,CAACG,IAAT,CAAcZ,QAAS,iCADjC;MAGD,CAPG,EAQHe,KARG,CAQIC,KAAD,IAAW;QAChBC,OAAO,CAACC,GAAR,CAAYF,KAAZ;MACD,CAVG,CAAN;IAWD,CAtCM;;IAuCPK,MAAM,GAAG;MACP,KAAKhC,KAAL,GAAa,IAAb;MACAI,YAAY,CAAC6B,UAAb,CAAwB,MAAxB;IACD,CA1CM;;IA4CPC,UAAU,GAAG;MACX,KAAK5B,UAAL,GAAkB,KAAlB;IACD;;EA9CM,CAV+C;EA0DxD6B,OAAO,EAAE;IACPC,OAAO,EAAE;EADF;AA1D+C,CAAnB,CAAhC"},"metadata":{},"sourceType":"module"}